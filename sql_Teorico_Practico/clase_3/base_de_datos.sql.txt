-- CREACION DE LA BASE DE DATOS
CREATE DATABASE [Clinica La Rioja];

USE [Clinica La Rioja];

CREATE SCHEMA dev; -- CREACION DEL SCHEMA

-- CREACION DE TABLAS DE CLINICA LA RIOJA

CREATE TABLE dev.Turnos(
[ID Turno] INT PRIMARY KEY IDENTITY,
[Fecha] DATE NOT NULL,
[Hora] TIME NOT NULL, -- LO ELIMINE A PARTIR DEL ALTER TABLE (19)
[Valor] DECIMAL(12,2),
[Observacion] TEXT);

-- DROP TABLE dev.Turnos; -- ELIMINA TABLA DE TURNOS.
-- ALTER TABLE dev.Turnos
-- DROP COLUMN [Hora]; -- ELIMINO EL CAMPO [HORA].
-- ALTER TABLE dev.Turnos
-- ALTER COLUMN [Fecha] DATETIME NOT NULL; -- MODIFICO NATURALEZA DE ESTE CAMPO.

CREATE TABLE dev.Pacientes(
[ID Paciente] INT PRIMARY KEY IDENTITY,
[Nombre] VARCHAR(255) NOT NULL,
[Apellido] VARCHAR(255) NOT NULL,
[Genero] CHAR(1) CHECK([Genero] IN('F','M','X')) DEFAULT 'X',
[Email] VARCHAR(255) UNIQUE,
[Fecha Nacimiento] DATE NOT NULL,
[Telefono] BIGINT NOT NULL,
[DNI] VARCHAR(255) NOT NULL); 

CREATE TABLE dev.Medicos(
[ID Medico] INT PRIMARY KEY IDENTITY,
[Nombre] VARCHAR(255) NOT NULL,
[Apellido] VARCHAR(255) NOT NULL,
[Fecha Nacimiento] DATE NOT NULL,
[Fecha Ingreso] DATE NOT NULL,
[DNI] VARCHAR(255) UNIQUE NOT NULL,
[Telefono] VARCHAR(255) NOT NULL,
[Email] VARCHAR(255) UNIQUE,
[Estado] VARCHAR(255) CHECK([Estado] IN('Activo','Inactivo')) DEFAULT 'Activo'); 

CREATE TABLE dev.Especialidades(
[ID Especialidad] INT PRIMARY KEY IDENTITY,
[Nombre] VARCHAR(255) NOT NULL); 

-- CREACION DE RELACIONES (CLAVE FORANEA Y CLAVE PRIMARIA)

ALTER TABLE dev.Turnos 
ADD [ID Paciente] INT; -- CREAMOS EL CAMPO ID PACIENTE EN TURNOS

ALTER TABLE dev.Turnos
ADD CONSTRAINT [FK Turnos Pacientes]
FOREIGN KEY([ID Paciente]) REFERENCES dev.Pacientes([ID Paciente])
ON DELETE SET NULL ON UPDATE SET NULL; -- INTEGRIDAD REFERENCIAL. 